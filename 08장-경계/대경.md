# 08장 경계

> 시작하기에 앞서 "경계" 라는 말이 와닫지 않았다. 이게 뭔지 찾아봤다.
> 경계(Boundaries)는 우리가 작성한 코드와 외부 시스템(라이브러리, 프레임워크, 타 시스템 등) 사이의 접점이라고 한다.
> 7장 오류처리 문단에서 이야기하던 "외부 api는 래퍼클래스(Wrapper)로 씌워야 한다"는 내용의 연장일거 같다.

- 시스템 에 들어가는 모든 소프트웨어를 직접 개발하는 경우는 드물다.
- 어떤 식으로든 이 외부 코드를 우리 코드에 깔끔하게 통합 해야만 한다.

## 외부 코드 사용하기

- 패키지 제공자나 프레임워크 제공자는 적용성을 최대한 넓히려 한다.
- 사용자는 자신의 요구에 집중하는 인터페이스를 바란다.
- 이런 긴장으로 인해 시스템 경계에 문제가 생길 소지가 많다.

> MAP 예제 코드
> 좋은 예제 코드

- Map 클래스를 사용할 때마다 위와 같이 캡슐화 하라는 소리가 아니다. Map을 혹은 유사한 경계 인터페이스를 여기저기 넘기지 말라는 말이다.
- 경계 인터페이스를 이용할 때는 이를 이용하는 클래스나 클래스 계열 밖으로 노출되지 않도록 주의한다.

> 읽자마자 바로 prisma(orm) 인터페이스가 생각났다. 전 기수들의 코드를 참고해서 prisma의 인터페이스들을 최대한 해당 repository클래스에 묶기위해 내가 여러가지 타입을 직접만들고 사용한게 기억난다.

## 경계 살피고 익히기

- 외부 패키지 테스트가 우리 책임은 아니지만 우리 자신을 위해 우리가 사용할 코드를 테스트 하는 편이 바람직하다.

- 외부 코드를 익히기는 어렵다.
- 곧바로 코드를 사용하는 대신 먼저 간단한 테스트 케이스를 작성해 외부 코드를 익히면 어떨까? 짐 뉴커크는 이를 "학습 테스트"라 부른다.

- 학습테스트는 통제된 환경에서 API를 제대로 이해하는지를 확인하는 셈이다.
  > 문서를 읽는거에 더 나아가 먼저 연습을 테스트 케이스로 하는 방법을 말하고 있다. 이를 gpt랑 이야기해보니 바로 학습 테스트 템플릿를 생성해 줬다. Jest, axios 테스트 템플릿을 만들어 주었는데, 좋은 학습 방향으로 느꼈다.

### Iog4j 익히기

- 로깅 기능을 직접 구현하는 대신 아파치의 log4j 패키지를 사용하려 한다고 가정하자.

> log4j 공부하던 글쓴이의 흐름

- 간단한 콘솔 로거를 초기화 하는 방법을 익혔으니, 이제 모든 지식을 독자적인 로거 클래스로 캡슐화 한다. 그러면 나머지 프로그램은 log4j 경계 인터페이스를 몰라도 된다.

## 학습 테스트는 공짜 이상이다

- 어쨋듣 API를 배워야 하므로 학습 테스트에 드는 비용은 없다.
- 학습 테스트는 이해도를 높여주는 정확한 실험이다. 투자하는 노력보다 얻는 성과가 크다.

- 새 버전이 나온다면, 학습 테스트를 돌려 차이가 있는지 확인한다.
- 새 버전이 우리 코드와 호환되지 않으면 학습 테스트가 이 사실을 곧바로 밝혀낸다.

- 실제 코드와 동일한 방식으로 인터페이스를 사용하는 테스트 케이스가 필요하다. 이런 경계 테스트가 있다면 패키지 새버전으로 이전하기 쉬워진다.
- 그렇지 않다면 낡은 버전을 필요 이상으로 오랫동안 사용하려는 유혹에 빠지기 쉽다.

## 아직 존재하지 않는 코드를 사용하기

> 이 부분 좀 어려움 다시 읽어보게 일단 보류

## 깨끗한 경계

- 경계에서는 흥미로운 일이 많이 벌어진다. 변경이 대표적인 예다.
- 소프트웨어 설계가 우수하다면 변경하는데 많은 투자와 재작업이 필요하지 않다.

- 경계에 위치하는 코드는 깔끔히 분리한다.
- 테스트 케이스도 작성한다.

- 외부 패키지를 호출하는 코드를 가능한 줄여 경계를 관리하자. 새로운 클래스로 감싸거나, ADAPTER패턴을 사용해 우리가 원하는 인터페이스로 변환하자.
