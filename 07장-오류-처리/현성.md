# 7장 오류 처리

- 오류 처리는 프로그램에 반드시 필요한 요소 중 하나이다.
- 상당수 코드 기반은 전적으로 오류 처리 코드에 좌우된다.

## 오류 코드보다 예외를 사용하라

예외 미사용

```java
public class DeviceController {
  ...
  public void sendShutDown() {
    DeviceHandle handle = getHandle(DEV1);
    // 디바이스 상태를 점검한다.
    if (handle != DeviceHandle.INVALID) {
      // 레코드 필드에 디바이스 상태를 저장한다.
      retrieveDeviceRecord(handle);
      // 디바이스가 일시정지 상태가 아니라면 종료한다.
      if (record.getStatus() != DEVICE_SUSPENDED) {
        pauseDevice(handle);
        clearDeviceWorkQueue(handle);
        closeDevice(handle);
      } else {
        logger.log("Device suspended. Unable to shut down");
      }
    } else {
      logger.log("Invalid handle for: " + DEV1.toString());
    }
  }
  ...
}
```

- 위 코드에서는 함수를 호출한 즉시 오류를 확인해야 하기 때문에 호출자 코드가 복잡해진다.

예외 사용

```java
public class DeviceController {
  ...
  public void sendShutDown() {
    try {
      tryToShutDown();
    } catch (DeviceShutDownError e) {
      logger.log(e);
    }
  }

  private void tryToShutDown() throws DeviceShutDownError {
    DeviceHandle handle = getHandle(DEV1);
    DeviceRecord record = retrieveDeviceRecord(handle);

    pauseDevice(handle);
    clearDeviceWorkQueue(handle);
    closeDevice(handle);
  }

  private DeviceHandle getHandle(DeviceID id) {
    ...
    throw new DeviceShutDownError("Invalid handle for: " + id.toString());
    ...
  }
  ...
}
```

- 예외를 사용했을 때 디바이스를 종료하는 알고리즘과 오류를 처리하는 알고리즘을 분리하여 단순히 보기만 좋아지는 것이 아니라, 코드 품질도 나아졌다.

## Try-Catch-Finally 문부터 작성하라

- 예외에서 프로그램 안에다 범위를 정의한다는 사실은 매우 흥미롭다
- try-catch-finally 문에서 try 블록에 들어가는 코드를 실행하면 어느 시점에서든 실행이 중단된 후 catch 블록으로 넘어갈 수 있다.

## 미확인(unchecked) 예외를 사용하라

- 안정적인 소프트웨어를 제작하는 요소로 확인된 예외가 반드시 필요하지는 않는다는 사실이 분명해졌다.
- 확인된 예외는 OCP(Open Closed Principle)를 위반한다.

## 예외에 의미를 제공하라

- 예외를 던질 때 전후 상황을 충분히 덧붙이면 오류가 발생하는 원인과 위치를 찾기 쉬워진다.
- 오류 메시지에 정보를 담아 예외와 함께 던진다.
- 실패한 연산 이름 및 실패 유형도 언급한다.

## 호출자를 고려해 예외 클래스를 정의하라

## 정상 흐름을 정의하라

## null을 반환하지 마라

## null을 전달하지 마라

## 결론

### ⭐ 감상문
